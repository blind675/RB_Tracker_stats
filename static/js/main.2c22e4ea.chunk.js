(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{164:function(e,t,a){e.exports=a(389)},169:function(e,t,a){},389:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),i=a(17),o=a.n(i),r=a(93),c=a(153),s=a(154),d=a(162),u=a(155),m=a(39),p=a(163),b=(a(169),a(41)),g=a.n(b),h=a(40),v=a(158),f=a(92),y=(a(370),a(159)),k=(a(371),a(160)),E={apiKey:"AIzaSyCzenI1WpO2JBbltc3ARFKTCJyUumY-zkk",authDomain:"rbtrack-ab0e9.firebaseapp.com",databaseURL:"https://rbtrack-ab0e9.firebaseio.com",projectId:"rbtrack-ab0e9",storageBucket:"rbtrack-ab0e9.appspot.com",messagingSenderId:"381452575978",appId:"1:381452575978:web:9999b9c4b6d38967"},S=[{label:"",value:null},{label:"Stay",value:"stay"},{label:"Walk",value:"walk"},{label:"Car",value:"car"},{label:"Bike",value:"bike"},{label:"e-Bike",value:"e-bike"},{label:"Scooter",value:"scooter"},{label:"e-Scooter",value:"e-scooter"},{label:"e-Board",value:"rb"},{label:"e-Board Bad Road",value:"rb-bad"}],D=[{label:"id",key:"id"},{label:"x1",key:"x1"},{label:"y1",key:"y1"},{label:"z1",key:"z1"},{label:"x2",key:"x2"},{label:"y2",key:"y2"},{label:"z2",key:"z2"},{label:"x3",key:"x3"},{label:"y3",key:"y3"},{label:"z3",key:"z3"},{label:"x4",key:"x4"},{label:"y4",key:"y4"},{label:"z4",key:"z4"},{label:"x5",key:"x5"},{label:"y5",key:"y5"},{label:"z5",key:"z5"},{label:"altitude",key:"altitude"},{label:"accuracy",key:"accuracy"},{label:"label",key:"label"}],w=Object(h.withScriptjs)(Object(h.withGoogleMap)(function(e){return n.a.createElement(h.GoogleMap,{defaultZoom:16,defaultCenter:{lat:45.757855,lng:21.228995}},e.isMarkerShown&&e.markers)})),x=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(u.a)(t).call(this,e))).state={locations:[],loading:!1,selectedActionAtPoint:null,csvData:null,drawMap:!1,selectedList:[]},a.csvFileName="RBStats.csv",a._updatePoints=a._updatePoints.bind(Object(m.a)(a)),a._deletePoints=a._deletePoints.bind(Object(m.a)(a)),a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.db=k.initializeApp(E);var e=new Date,t=e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear();this.csvFileName="RBStats-"+t+".csv",this._reloadFirebaseData()}},{key:"_reloadFirebaseData",value:function(){var e=this;this.setState({loading:!0}),this.db.firestore().collection("geo_points").get().then(function(t){var a=t.docs.map(function(e){return Object(r.a)({},e.data(),{id:e.id})});e.setState({loading:!1,locations:a,drawMap:!0}),e._createCSVData(a)}).catch(function(t){e.setState({loading:!1,locations:[],drawMap:!0}),console.log("error:",t)})}},{key:"_createCSVData",value:function(e){var t=[];e.forEach(function(e){e.label&&t.push({id:String(e.accelerometerData[0].id),x1:String(e.accelerometerData[0].x),y1:String(e.accelerometerData[0].y),z1:String(e.accelerometerData[0].z),x2:String(e.accelerometerData[1].x),y2:String(e.accelerometerData[1].y),z2:String(e.accelerometerData[1].z),x3:String(e.accelerometerData[2].x),y3:String(e.accelerometerData[2].y),z3:String(e.accelerometerData[2].z),x4:String(e.accelerometerData[3].x),y4:String(e.accelerometerData[3].y),z4:String(e.accelerometerData[3].z),x5:String(e.accelerometerData[4].x),y5:String(e.accelerometerData[4].y),z5:String(e.accelerometerData[4].z),altitude:String(e.altitude),accuracy:String(e.accuracy),label:e.label})}),this.setState({csvData:t})}},{key:"_deletePoints",value:function(){var e=this;Object(y.confirmAlert)({title:"Are you sure?",message:"This will remove all the points that have been assigned labels. Please make sure you have downloaded a .cvs file before deleting points.",buttons:[{label:"Yes",onClick:function(){var t=[];e.state.locations.forEach(function(a){if(a.label){var l=e.db.firestore().collection("geo_points").doc(a.id);t.push(l.delete())}}),Promise.all(t).then(function(){e.setState({selectedList:[],selectedActionAtPoint:null,locations:[]}),e._reloadFirebaseData()})}},{label:"No"}]})}},{key:"_updatePoints",value:function(){var e=this;if(this.state.selectedActionAtPoint){this.setState({loading:!0});var t=[];this.state.selectedList.forEach(function(a){var l=e.state.locations.find(function(e){return e.id===a}),n=e.db.firestore().collection("geo_points").doc(l.id),i=Object(r.a)({},l,{label:e.state.selectedActionAtPoint.value});t.push(n.update(i))}),Promise.all(t).then(function(){e.setState({selectedList:[],selectedActionAtPoint:null,locations:[]}),e._reloadFirebaseData()})}else alert(" Please select an action did at a location. ")}},{key:"_selectDeselectMarker",value:function(e){var t=this.state.locations.find(function(t){return t.id===e.id}),a=[];if(t.label)a.push(t.id);else if(this.state.selectedList.includes(e.id)){var l=this.state.selectedList.indexOf(e.id);l>-1&&this.state.selectedList.splice(l,1),a=this.state.selectedList}else this.state.selectedList.push(e.id),a=this.state.selectedList;this.setState({drawMap:!0,selectedList:a})}},{key:"_renderDownloadCSVButton",value:function(){return this.state.csvData?n.a.createElement("div",{id:"downloadDiv"},n.a.createElement(v.CSVLink,{style:{margin:12},data:this.state.csvData,filename:this.csvFileName,headers:D},"Download .CSV"),n.a.createElement("p",null,"After the download please upload the file to Reactive Boards Google Drive."),n.a.createElement(g.a,{variant:"danger",onClick:this._deletePoints,style:{hight:60,width:200,marginTop:16,marginBottom:16,marginRight:32}},"Delete Points")):null}},{key:"_renderPoints",value:function(){var e=this;return this.state.locations.map(function(t){var a;switch(t.label){case"stay":a="http://maps.google.com/mapfiles/kml/paddle/wht-square-lv.png";break;case"walk":a="http://maps.google.com/mapfiles/kml/paddle/wht-blank-lv.png";break;case"car":a="http://maps.google.com/mapfiles/kml/paddle/wht-circle-lv.png";break;case"bike":a="http://maps.google.com/mapfiles/kml/paddle/purple-circle-lv.png";break;case"e-bike":a="http://maps.google.com/mapfiles/kml/paddle/purple-square-lv.png";break;case"scooter":a="http://maps.google.com/mapfiles/kml/paddle/blu-circle-lv.png";break;case"e-scooter":a="http://maps.google.com/mapfiles/kml/paddle/blu-stars-lv.png";break;case"rn":a="http://maps.google.com/mapfiles/kml/paddle/grn-diamond-lv.png";break;case"rb-bad":a="http://maps.google.com/mapfiles/kml/paddle/red-diamond-lv.png";break;default:a=null}return null===a&&(a="http://maps.google.com/mapfiles/ms/icons/red-dot.png",e.state.selectedList.includes(t.id)&&(a="http://maps.google.com/mapfiles/kml/paddle/orange-circle.png")),n.a.createElement(h.Marker,{position:{lat:t.latitude,lng:t.longitude},onClick:function(){e._selectDeselectMarker(t)},name:"Test",title:"Test marker",key:t.id,icon:{url:a}})})}},{key:"_renderSelectedPoint",value:function(){var e=this;if(1===this.state.selectedList.length){var t=this.state.locations.find(function(t){return t.id===e.state.selectedList[0]});return t.label?n.a.createElement("div",{style:{display:"flex",flex:1,flexDirection:"column",margin:12}},n.a.createElement("label",null,"Latitude: ",t.latitude," "),n.a.createElement("label",null,"Longitude: ",t.longitude," "),n.a.createElement("label",null,"Accuracy: ",t.accuracy," "),n.a.createElement("br",null),n.a.createElement("label",null,"UniqueId: ",t.uniqueId," "),n.a.createElement("label",null,"Manufacturer: ".concat(t.manufacturer)),n.a.createElement("label",null,"Action did at location: ",n.a.createElement("b",null,t.label))):n.a.createElement("div",{style:{display:"flex",flex:1,flexDirection:"column",margin:12}},n.a.createElement("label",null,"Latitude: ",t.latitude," "),n.a.createElement("label",null,"Longitude: ",t.longitude," "),n.a.createElement("label",null,"Accuracy: ",t.accuracy," "),n.a.createElement("br",null),n.a.createElement("label",null,"UniqueId: ",t.uniqueId," "),n.a.createElement("label",null,"Manufacturer: ".concat(t.manufacturer)),n.a.createElement("label",null,"Select action did at location : "),n.a.createElement(f.a,{options:S,onChange:function(t){console.log("  value:",t),e.setState({selectedActionAtPoint:t})}}),n.a.createElement(g.a,{variant:"primary",onClick:this._updatePoints,style:{hight:60,width:200,display:"flex",flex:1,marginTop:16,marginBottom:16}},"Update"))}return this.state.selectedList.length>1?n.a.createElement("div",{style:{display:"flex",flex:1,flexDirection:"column",margin:12}},n.a.createElement("label",null,"Select ",this.state.selectedList.length," points"),n.a.createElement("label",null,"Select action did at locations : "),n.a.createElement(f.a,{options:S,onChange:function(t){console.log("  value:",t),e.setState({selectedActionAtPoint:t})}}),n.a.createElement(g.a,{variant:"primary",onClick:this._updatePoints,style:{hight:60,width:200,display:"flex",flex:1,marginTop:16,marginBottom:16}},"Update All")):null}},{key:"_renderMap",value:function(){return!0===this.state.drawMap?n.a.createElement(w,{isMarkerShown:!0,googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places",loadingElement:n.a.createElement("div",{style:{height:"100%"}}),containerElement:n.a.createElement("div",{style:{height:"100%"}}),mapElement:n.a.createElement("div",{style:{height:"100%"}}),markers:this._renderPoints()}):null}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{id:"mainDiv"},n.a.createElement("div",{id:"headerDiv"}),n.a.createElement("div",{id:"rowDiv"},n.a.createElement("div",{id:"mapDiv"},this._renderMap()),n.a.createElement("div",{id:"statsDiv"},n.a.createElement("h3",{align:"center"}," Selected Point "),this._renderSelectedPoint())),n.a.createElement("div",{id:"reloadDiv"},n.a.createElement(g.a,{variant:"secondary",disabled:this.state.loading,onClick:function(){e._reloadFirebaseData()},style:{margin:12}},"Reload"),n.a.createElement("label",null,this.state.loading?"loading...":"not loading")),this._renderDownloadCSVButton())}}]),t}(l.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[164,1,2]]]);
//# sourceMappingURL=main.2c22e4ea.chunk.js.map